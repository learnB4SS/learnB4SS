<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Application to regression II - Priors and Bayesian updating • learnB4SS</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Application to regression II - Priors and Bayesian updating">
<meta property="og:description" content="learnB4SS">
<meta property="og:image" content="https://learnb4ss.github.io/learnB4SS/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnB4SS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.7.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Get started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/install-brms.html">Install brms and dependencies</a>
    </li>
    <li>
      <a href="../articles/install-learnb4ss.html">Install the learnB4SS package</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Slides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Day 1</li>
    <li>
      <a href="https://learnb4ss.github.io/slides/00_intro/index.pdf">0. Introduction</a>
    </li>
    <li>
      <a href="https://learnb4ss.github.io/slides/01_a2r_initial_demo/index.html">1. Application to regression I — Demo</a>
    </li>
    <li>
      <a href="https://learnb4ss.github.io/slides/02_bayes_theorem/index.pdf">2. Bayes theorem — How does it work?</a>
    </li>
    <li>
      <a href="https://learnb4ss.github.io/slides/03_a2r_priors_and_bayesian_updating/index.html">3. Application to regression II — Priors and Bayesian updating</a>
    </li>
    <li>
      <a href="https://learnb4ss.github.io/slides/04_nhst_vs_bayesian_inference/index.pdf">4. NHST vs. Bayesian inference</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Day 2</li>
    <li>
      <a href="https://learnb4ss.github.io/slides/05_review/index.html">5. Interim review</a>
    </li>
    <li>
      <a href="https://learnb4ss.github.io/slides/06_a2r_inference_over_posterior/index.html">6. Application to regression III — More Bayesian inference</a>
    </li>
    <li>
      <a href="https://learnb4ss.github.io/slides/07_more_priors/index.html">7. More on priors</a>
    </li>
    <li>
      <a href="https://learnb4ss.github.io/slides/08_a2r_leveling_up/index.pdf">8. Application to regression IV — Leveling up</a>
    </li>
    <li>
      <a href="https://learnb4ss.github.io/slides/09_sample_the_posterior/index.html">9. Sampling from the posterior</a>
    </li>
    <li>
      <a href="https://learnb4ss.github.io/slides/10_wrap_up/index.pdf">10. Wrap up</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Day 1</li>
    <li>
      <a href="../articles/ex_03.html">3. Application to regression II — Priors and Bayesian updating</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Day 2</li>
    <li>
      <a href="../articles/ex_06.html">6. Application to regression III - More Bayesian inference</a>
    </li>
    <li>
      <a href="../articles/ex_08.html">8. Application to regression IV - Leveling up to hierarchical models</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Day 3</li>
    <li>
      <a href="../articles/full-analysis.html">Fully worked-out analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/faqs.html">FAQs</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extras
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/why-bayes.html">Why Bayesian?</a>
    </li>
    <li>
      <a href="../articles/glossary.html">Glossary</a>
    </li>
    <li>
      <a href="../articles/understand-priors.html">Understand priors</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/learnB4SS/learnB4SS/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ex_03_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Application to regression II - Priors and Bayesian updating</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/learnB4SS/learnB4SS/blob/master/vignettes/ex_03.Rmd"><code>vignettes/ex_03.Rmd</code></a></small>
      <div class="hidden name"><code>ex_03.Rmd</code></div>

    </div>

    
    
<div id="load-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h1>
<p>Let’s load the packages and data we are going to use.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/learnB4SS/learnB4SS">learnB4SS</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/twolodzko/extraDistr">extraDistr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>

<span class="co"># Data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"polite"</span><span class="op">)</span></code></pre></div>
</div>
<div id="which-priors" class="section level1">
<h1 class="hasAnchor">
<a href="#which-priors" class="anchor"></a>Which priors?</h1>
<p>Depending on the type of model you are running and the nature of the included predictors, you will have to specify a certain set of priors.</p>
<p>You can easily learn which priors you can specify in a model by using the function <code><a href="https://rdrr.io/pkg/brms/man/get_prior.html">brms::get_prior()</a></code>. You will try it out in a second.</p>
<p>We are trying to find out what kind of effect politeness has (if any) on articulation rate.</p>
<p>As a first approximation, we could start with the following model:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Don't run me yet!</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span>
  formula <span class="op">=</span> <span class="va">articulation_rate</span> <span class="op">~</span> <span class="va">attitude</span>,
  data <span class="op">=</span> <span class="va">polite</span>
<span class="op">)</span></code></pre></div>
<p>To find out which priors are available in this model, you just need to specify the model formula <em>and</em> the data in the <code><a href="https://rdrr.io/pkg/brms/man/get_prior.html">get_prior()</a></code> function.</p>
<p>Go ahead and fill in the following code snippet and run it when you’re done to get a list of priors! You’ll learn how to interpret the output in the next section.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/brms/man/get_prior.html">get_prior</a></span><span class="op">(</span>
 formula <span class="op">=</span> <span class="va">...</span>,
 data <span class="op">=</span> <span class="va">...</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="understand-the-syntax" class="section level1">
<h1 class="hasAnchor">
<a href="#understand-the-syntax" class="anchor"></a>Understand the syntax</h1>
<p>When you run <code><a href="https://rdrr.io/pkg/brms/man/get_prior.html">get_prior()</a></code>, a table is returned with a few columns. Each row corresponds to one prior (and to one model parameter).</p>
<p>For now, you can focus just on the first three (<code>prior</code>, <code>class</code>, <code>coef</code>).</p>
<div id="prior" class="section level2">
<h2 class="hasAnchor">
<a href="#prior" class="anchor"></a><code>prior</code>
</h2>
<p>The column <code>prior</code> tells you which prior probability distributions are set as default by brms. For our model, the first two default priors are <code>(flat)</code>, i.e. uniform distributions (all values are equally probable). The other two priors are Student-<em>t</em> distributions. (more on prior specification below).</p>
<p>But we will want to change them all to something more appropriate (we will talk about what makes an appropriate prior tomorrow).</p>
</div>
<div id="class" class="section level2">
<h2 class="hasAnchor">
<a href="#class" class="anchor"></a><code>class</code>
</h2>
<p>The columns <code>class</code> and <code>coef</code> are the ones you should check. <code>class</code> indicates the type of model parameter: <code>Intercept</code> is the model intercept,<code>b</code> indicates a predictor term, and <code>sigma</code> the model’s residual standard deviation.</p>
</div>
<div id="coef" class="section level2">
<h2 class="hasAnchor">
<a href="#coef" class="anchor"></a><code>coef</code>
</h2>
<p>The third column, <code>coef</code> indicates to which model predictor the prior is assigned. In our model above, there’s only one predictor (<code>attitude</code>), and that’s what you can see in the <code><a href="https://rdrr.io/pkg/brms/man/get_prior.html">get_prior()</a></code> output.</p>
<p>Since <code>attitude</code> has only two levels (<code>inf</code> and <code>pol</code>), we only have one parameter for the second level <code>pol</code> (the level <code>inf</code> is included in the <code>Intercept</code>).</p>
</div>
</div>
<div id="specify-your-priors" class="section level1">
<h1 class="hasAnchor">
<a href="#specify-your-priors" class="anchor"></a>Specify your priors</h1>
<p>It’s quite easy to specify priors with brms. You just need to use the function <code><a href="https://rdrr.io/pkg/brms/man/set_prior.html">prior()</a></code>!</p>
<p>Since we need to specify more than one prior, we need multiple calls to <code><a href="https://rdrr.io/pkg/brms/man/set_prior.html">prior()</a></code>, concatenated with <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>. Like in the following example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html">prior</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html">prior</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html">prior</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Within the function <code><a href="https://rdrr.io/pkg/brms/man/set_prior.html">prior()</a></code>, you need to specify the prior distribution with its parameters, the prior class (<code>class</code>), and the prior coefficient (<code>coef</code>) if any.</p>
<p>For our simple model above, we need three priors:</p>
<ul>
<li>The prior of the <code>Intercept</code>.</li>
<li>The prior of the slope for <code>attitudepol</code>.</li>
<li>The prior for the standard deviation <code>sigma</code>.</li>
</ul>
<p>Remember that <code><a href="https://rdrr.io/pkg/brms/man/get_prior.html">get_prior()</a></code> also lists class-generic priors (in our case, the prior for <code>class = b</code>), but you don’t need to specify those if you specify the prior for the coefficient (in our case, <code>class = b, coef = attitudepol</code>).</p>
<p>We’ll give you a head start by telling you which priors we can use in this model:</p>
<ul>
<li>
<code>Intercept</code>: a Normal distribution with mean = 0 and sd = 15.</li>
<li>
<code>attitudepol</code>: a Normal distribution with mean = 0 and sd = 10.</li>
<li>
<code>sigma</code>: a Half-Cauchy distribution with mean = 0 and sd = 1.</li>
</ul>
<p>The Half Cauchy distribution is something we haven’t seen yet. This distribution is helpful for estimating measures like standard deviations. It’s “half” because only the positive values are taken into consideration, since the standard deviation can only ever be positive.</p>
<p>This is how a Half Cauchy distribution with mean 0 and standard deviation 1 looks like:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/HalfCauchy.html">dhcauchy</a></span><span class="op">(</span><span class="va">x</span>, sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Articulation rate (syl/s)"</span>, y <span class="op">=</span> <span class="st">"Density"</span>,
    title <span class="op">=</span> <span class="st">"Half Cauchy distribution"</span>,
    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">mu</span>, <span class="st">"=0"</span>, <span class="st">", "</span>, <span class="va">sigma</span>, <span class="st">"=1"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="ex_03_files/figure-html/half-cauchy-1.png" width="700"></p>
<p>As you can see, the probability of getting bigger values drops very quickly while moving away from 0. This ensures that the prior for the standard deviation has a “regularising” effect (we will talk about regularising priors tomorrow), which helps brms to estimate the standard deviation.</p>
<p>Now go ahead and fill in the following code snippet with the right parameters and arguments:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="va">...</span>, <span class="va">...</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">Intercept</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="va">...</span>, <span class="va">...</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">b</span>, coef <span class="op">=</span> <span class="va">...</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">cauchy</span><span class="op">(</span><span class="fl">0</span>, <span class="va">...</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">...</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>And now let’s fit the model using our priors!</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b_mod_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span>
  <span class="va">articulation_rate</span> <span class="op">~</span> <span class="va">attitude</span>,
  data <span class="op">=</span> <span class="va">polite</span>,
  prior <span class="op">=</span> <span class="va">my_priors</span>
<span class="op">)</span></code></pre></div>
<p><br></p>
<!--
Solutions to exercise 03.

get_prior(
 formula = articulation_rate ~ attitude,
 data = polite
)

my_priors <- c(
  prior(normal(0, 15), class = Intercept),
  prior(normal(0, 10), class = b, coef = attitudepol),
  prior(cauchy(0, 1), class = sigma)
)
-->
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Stefano Coretta, Joseph V. Casillas, Timo Roettger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="learnB4SS">
<title>Factors, coding and contrasts • learnB4SS</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Factors, coding and contrasts">
<meta property="og:description" content="learnB4SS">
<meta property="og:image" content="https://learnb4ss.github.io/learnB4SS/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">learnB4SS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.7.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/contrasts.html">Factors, coding and contrasts</a>
    <a class="dropdown-item" href="../articles/ex_03.html">Application to regression II - Priors and Bayesian updating</a>
    <a class="dropdown-item" href="../articles/ex_06.html">Application to regression III - More Bayesian inference</a>
    <a class="dropdown-item" href="../articles/ex_08.html">Application to regression IV - Leveling up to hierarchical models</a>
    <a class="dropdown-item" href="../articles/faqs.html">FAQs</a>
    <a class="dropdown-item" href="../articles/full-analysis.html">Fully worked-out analysis using a Bayesian regression with brms</a>
    <a class="dropdown-item" href="../articles/glossary.html">Glossary</a>
    <a class="dropdown-item" href="../articles/install-brms.html">How to install brms and dependecies</a>
    <a class="dropdown-item" href="../articles/install-learnb4ss.html">How to install the learnB4SS package</a>
    <a class="dropdown-item" href="../articles/understand-priors.html">Understand and explore priors</a>
    <a class="dropdown-item" href="../articles/why-bayes.html">Why Bayesian?</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/learnB4SS/learnB4SS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Factors, coding and contrasts</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/learnB4SS/learnB4SS/blob/HEAD/vignettes/contrasts.Rmd" class="external-link"><code>vignettes/contrasts.Rmd</code></a></small>
      <div class="d-none name"><code>contrasts.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/learnB4SS/learnB4SS" class="external-link">learnB4SS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette is an overview of how factors (i.e. categorical
variables) are coded under the hood using dummy coding and which types
of dummy coding can be set in R.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>There’s seems to be a bit of terminological mix-up in the wild, so we
first present a terminological set that will be used throughout the
vignette.</p>
<p>Categorical variables in R are generally stored using factors. A
<strong>factor</strong> is a vector of values from a categorical
variable. The possible values in a factor are called
<strong>levels</strong> in R.</p>
<p>For each observation in the factor, the vector specifies the level of
that observation.</p>
<p>For example, let’s assume we have a data set with information on
dinosaurs and one column specifies the dinosaur’s diet:
<code>carnivore</code>, <code>herbivore</code>,
<code>omnivore</code>.</p>
<p>In R, this column can be coded as a factor:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"carnivore"</span>, <span class="st">"carnivore"</span>, <span class="st">"herbivore"</span>, <span class="st">"omnivore"</span>, <span class="st">"herbivore"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] carnivore carnivore herbivore omnivore  herbivore</span></span>
<span><span class="co">#&gt; Levels: carnivore herbivore omnivore</span></span></code></pre></div>
<p>We are so accustomed to using factors in regression models that
sometimes we forget that regressions only work with numbers and cannot
work with categorical variables.</p>
<p>To fit a regression model with categorical variables, these are first
converted to numbers. The process of conversion is called
<strong>coding</strong>.</p>
<p>One type of coding is the <strong>dummy variable coding</strong> or
simply <strong>dummy coding</strong>. This consists of assigning
<code>0</code>s or <code>1</code>s to the levels in the variable.</p>
<p>Let’s go through a simple example of dummy coding of a categorical
variable with only 2 levels: <code>metropolitan</code> and
<code>rural</code>.</p>
<p>The most simple way of coding this categorical variable as a number
is to assign <code>0</code> to one level and <code>1</code> to the other
level. For example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rural"</span>, <span class="st">"rural"</span>, <span class="st">"metropolitan"</span>, <span class="st">"rural"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] rural        rural        metropolitan rural       </span></span>
<span><span class="co">#&gt; Levels: metropolitan rural</span></span>
<span><span class="co"># dummy coded</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0 0 1 0</span></span></code></pre></div>
<p>In R, dummy coding is done under the hood for you when using factors,
so you don’t have to worry about the conversion.</p>
<p>When the categorical variable has 3 levels instead of 2, we need a
work-around in order to code the 3-level factor with only
<code>0</code>s and <code>1</code>s (we can’t use higher numbers for
reasons we will see later).</p>
<p>With three levels, we can code the variable using two numeric
variables (instead of just one). Going back to the dinosaur’s diet
example, we can use:</p>
<ul>
<li>One variable that codes whether the dinosaur is a carnivore
<code>0</code> or a herbivore <code>1</code>.</li>
<li>One variable that codes whether the dinosaur is a carnivore
<code>0</code> or an omnivore <code>1</code>.</li>
</ul>
<p>Let call the first variable <code>dummy_1</code> and the second
variable <code>dummy_2</code>. Then:</p>
<ul>
<li>When <code>dummy_1</code> is <code>0</code> and <code>dummy_2</code>
is also <code>0</code>, the dinosaur is a carnivore.</li>
<li>When <code>dummy_1</code> is <code>1</code> and <code>dummy_2</code>
is <code>0</code>, the dinosaur is a herbivore.</li>
<li>When <code>dummy_1</code> is <code>0</code> and <code>dummy_2</code>
is <code>1</code>, the dinosaur is an omnivore.</li>
</ul>
<p>So the following factor (repeated from above):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"carnivore"</span>, <span class="st">"carnivore"</span>, <span class="st">"herbivore"</span>, <span class="st">"omnivore"</span>, <span class="st">"herbivore"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] carnivore carnivore herbivore omnivore  herbivore</span></span>
<span><span class="co">#&gt; Levels: carnivore herbivore omnivore</span></span></code></pre></div>
<p>can be coded as:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dummy_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>     <span class="co"># carnivore (0) or herbivore (1)?</span></span>
<span><span class="va">dummy_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>     <span class="co"># carnivore (0) or omnivore (1)?</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  <span class="va">dummy_1</span>, <span class="va">dummy_2</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">#&gt;   dummy_1 dummy_2</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       1       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       0       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       1       0</span></span></code></pre></div>
<p>If this doesn’t make much sense, try and figure it out by checking
the value of the two columns for each row with the following code:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># case_when() is a very helpful function from dplyr!</span></span>
<span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>  <span class="va">dummy_1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">dummy_2</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"carnivore"</span>,</span>
<span>  <span class="va">dummy_1</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">dummy_2</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"herbivore"</span>,</span>
<span>  <span class="va">dummy_1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">dummy_2</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"omnivore"</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
<p>What if the factor has 4 levels? Then you can code it with 3 dummy
variables. And what about 5 levels? Use 4 dummy variables. The number of
dummy variables needed is equal to the number of levels minus 1 (<span class="math inline">\(n_{dummy} = n_{levels} - 1\)</span>).</p>
<div class="section level3">
<h3 id="summing-up">Summing up<a class="anchor" aria-label="anchor" href="#summing-up"></a>
</h3>
<p>To sum up:</p>
<ul>
<li>
<strong>Factors</strong> are vectors that code categorical
variables.</li>
<li>The values in a factor are called <strong>levels</strong>.</li>
<li>Regression models cannot work directly with factors, so these are
coded using numbers.</li>
<li>
<strong>Dummy coding</strong> is one way of coding factors as
numbers using one or more numeric variables of <code>0</code>s and
<code>1</code>s.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="coding-and-contrasts">Coding and contrasts<a class="anchor" aria-label="anchor" href="#coding-and-contrasts"></a>
</h2>
<p>Now. We’ve seen that dummy coding is simply using dummy numeric
variables with <code>0</code>s and <code>1</code>s.</p>
<p>In fact, this is <strong>one way</strong> of coding factors, or one
coding scheme.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;You can learn about more coding schemes here: &lt;a href="https://stats.idre.ucla.edu/spss/webbooks/reg/chapter5/regression-with-spsschapter-5-additional-coding-systems-for-categorical-variables-in-regressionanalysis/" class="external-link uri"&gt;https://stats.idre.ucla.edu/spss/webbooks/reg/chapter5/regression-with-spsschapter-5-additional-coding-systems-for-categorical-variables-in-regressionanalysis/&lt;/a&gt;.&lt;/p&gt;'><sup>1</sup></a> Different coding schemes in R are called
<strong>contrasts</strong>. Dummy coding is called <strong>treatment
contrasts</strong> in R.</p>
<div class="section level3">
<h3 id="treatment-contrasts">Treatment contrasts<a class="anchor" aria-label="anchor" href="#treatment-contrasts"></a>
</h3>
<p>The term <strong>treatment contrasts</strong> comes from the clinical
sciences where you test, for example, the efficacy of a medical
intervention (a drug, surgery, etc…) by comparing a <strong>control
group</strong> (which has not received the “treatment”) with a group
that has received the medical intervention (the <strong>treatment
group</strong>).</p>
<p>The control group can be used as the reference group to see if the
treatment group has benefited from the medical treatment (i.e. if the
treatment group’s health has improved after the intervention relative to
the control group, then one can infer that the treatment was
effective).</p>
<p>Let’s look at treatment contrasts in R.</p>
<p>In the previous section, we’ve been illustrating dummy coding by
assigning <code>0</code>s and <code>1</code>s using one or more dummy
variables. In practice, you do not need to do that to run real analyses,
because R does that under the hood for you.</p>
<p>Factors in R are coded with treatment contrasts by default. Also by
default, the first level is set as the reference level (the order is
alphabetical by default). The reference level is the level that gets
coded only with <code>0</code>s, as we have seen above for the
dinosaur’s diet factor (<code>carnivorous</code> had
<code>dummy_1 = 0</code> and <code>dummy_2 = 0</code>).</p>
<p>Let’s see an example using a data table with measurements of vowel
duration.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"vowels"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">vowels</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 886</span></span>
<span><span class="co">#&gt; Columns: 9</span></span>
<span><span class="co">#&gt; $ item          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 20, 2, 11, 1, 15, 10, 13, 3, 14, 19, 4, 6, 16, 17, 5, 23…</span></span>
<span><span class="co">#&gt; $ speaker       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "it01", "it01", "it01", "it01", "it01", "it01", "it01", …</span></span>
<span><span class="co">#&gt; $ word          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "pugu", "pada", "poco", "pata", "boco", "podo", "boto", …</span></span>
<span><span class="co">#&gt; $ v1_duration   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 95.23720, 138.96844, 126.93226, 127.49888, 132.33310, 12…</span></span>
<span><span class="co">#&gt; $ c2_voicing    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "voiced", "voiced", "voiceless", "voiceless", "voiceless…</span></span>
<span><span class="co">#&gt; $ vowel         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "u", "a", "o", "a", "o", "o", "o", "a", "o", "u", "a", "…</span></span>
<span><span class="co">#&gt; $ c2_place      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "velar", "coronal", "velar", "coronal", "velar", "corona…</span></span>
<span><span class="co">#&gt; $ speech_rate   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4.893206, 5.015636, 4.819541, 5.031662, 5.063435, 5.0632…</span></span>
<span><span class="co">#&gt; $ speech_rate_c <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -0.55937531, -0.43694485, -0.63303978, -0.42091937, -0.3…</span></span></code></pre></div>
<p>For example, let’s take the <code>vowel</code> column. This column
indicates which vowel the measurement was taken from, and that can be
/a/, /o/, or /u/.</p>
<p>If we convert the <code>vowel</code> column into a factor, the levels
will be <code>a</code>, <code>o</code> and <code>u</code>, and
<code>a</code> will be the reference level.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vowels</span> <span class="op">&lt;-</span> <span class="va">vowels</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>vowel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">vowel</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">vowels</span><span class="op">$</span><span class="va">vowel</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "a" "o" "u"</span></span></code></pre></div>
<p>To get a sense of how a factor would be coded with treatment
contrasts, we can print a dummy coding table with the
<code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.treatment()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.treatment</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">vowels</span><span class="op">$</span><span class="va">vowel</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   o u</span></span>
<span><span class="co">#&gt; a 0 0</span></span>
<span><span class="co">#&gt; o 1 0</span></span>
<span><span class="co">#&gt; u 0 1</span></span></code></pre></div>
<p>Now, let’s run a regression model with <code>v1_duration</code> as
the outcome variable and <code>vowel</code> as the predictor.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vow_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">v1_duration</span> <span class="op">~</span> <span class="va">vowel</span>, data <span class="op">=</span> <span class="va">vowels</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">vow_lm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = v1_duration ~ vowel, data = vowels)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -66.874 -22.567  -2.293  17.025 106.755 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  128.616      1.806  71.227   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; vowelo        -5.641      2.549  -2.213   0.0272 *  </span></span>
<span><span class="co">#&gt; vowelu       -29.763      2.603 -11.432   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 31.38 on 883 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1419, Adjusted R-squared:  0.1399 </span></span>
<span><span class="co">#&gt; F-statistic: 72.99 on 2 and 883 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The summary returns three coefficients:</p>
<ul>
<li>
<code>Intercept</code>.</li>
<li>
<code>vowelo</code>.</li>
<li>
<code>vowelu</code>.</li>
</ul>
<p>Since <code>a</code> is the reference level of <code>vowel</code>,
the <code>Intercept</code> corresponds to the mean duration of the vowel
<code>a</code>, i.e. 128 ms.</p>
<p>The coefficient of <code>o</code> is the <strong>difference between
the mean duration of <code>o</code> and the mean duration of the
reference level <code>a</code></strong> (i.e. the
<code>Intercept</code>). So <code>o</code> is 5.6 ms shorter than
<code>a</code> on average (shorter because the coefficient is
negative).</p>
<p>Finally, the coefficient of <code>u</code> is the <strong>difference
between the mean duration of <code>u</code> and the mean duration of the
reference level <code>a</code></strong> So <code>u</code> is 29.7 ms
shorter than <code>a</code>.</p>
<p>This is how treatment contrasts work.</p>
</div>
<div class="section level3">
<h3 id="sum-contrasts">Sum contrasts<a class="anchor" aria-label="anchor" href="#sum-contrasts"></a>
</h3>
<p>Another type of coding is <strong>effect coding</strong>. In R, the
corresponding contrast type are the so-called <strong>sum
contrasts</strong>.</p>
<p>When using sum contrasts, the levels in a factor are coded using
<code>1</code>s, <code>-1</code>s and <code>0</code>s. If you sum the
values of each dummy variable you always get <code>0</code> (hence the
name “sum” contrast).</p>
<p>Let’s see what happens to the factor <code>vowel</code> when using
sum contrasts (remember that factors use treatment contrasts by
default).</p>
<p>This is how sum coding would look like for this factor:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">vowels</span><span class="op">$</span><span class="va">vowel</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [,1] [,2]</span></span>
<span><span class="co">#&gt; a    1    0</span></span>
<span><span class="co">#&gt; o    0    1</span></span>
<span><span class="co">#&gt; u   -1   -1</span></span></code></pre></div>
<p>Since there are 3 levels, we need two dummy variables. So
<code>a</code> is coded as <code>1, 0</code>, <code>o</code> is coded as
<code>0, 1</code>, and <code>u</code> as <code>-1, -1</code>.</p>
<p>To set the contrasts of a factor to sum coding, we can run the
following:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">vowels</span><span class="op">$</span><span class="va">vowel</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span><span class="co"># If you want to change it back to treatment contrasts you can run</span></span>
<span><span class="co"># contrasts(vowels$vowel) &lt;- "contr.treatment"</span></span></code></pre></div>
<p>With sum contrasts the reference level is in fact the grand mean.</p>
<p>In our model of vowel duration this means that the
<code>Intercept</code> coefficient will be the grand mean of vowel
duration.</p>
<p>Let’s rerun the model and look at the output.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vow_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">v1_duration</span> <span class="op">~</span> <span class="va">vowel</span>, data <span class="op">=</span> <span class="va">vowels</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">vow_lm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = v1_duration ~ vowel, data = vowels)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -66.874 -22.567  -2.293  17.025 106.755 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  116.815      1.055 110.728  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; vowel1        11.801      1.483   7.957 5.40e-15 ***</span></span>
<span><span class="co">#&gt; vowel2         6.160      1.481   4.160 3.49e-05 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 31.38 on 883 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1419, Adjusted R-squared:  0.1399 </span></span>
<span><span class="co">#&gt; F-statistic: 72.99 on 2 and 883 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The <code>Intercept</code> now is 116 ms, which mean that the mean of
vowel duration across the three vowels is 116 ms.</p>
<p>We can check this by taking the mean:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">vowels</span><span class="op">$</span><span class="va">v1_duration</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 117.2747</span></span></code></pre></div>
<p>Yup, pretty close (small differences are fine).</p>
<p>So what are now the coefficients called <code>vowel1</code> and
<code>vowel2</code>?</p>
<p>These are, respectively, the difference between the mean duration of
<code>a</code> and the grand mean, and the difference between the mean
duration of <code>o</code> and the grand mean.</p>
<p>So <code>a</code> is 11.8 ms longer than the grand mean, and
<code>o</code> is 6.1 ms longer than the grand mean.</p>
<p>What about <code>u</code> then?</p>
<p>Easy. You just subtract the coefficients of both <code>a</code> and
<code>o</code> from the grand mean: <span class="math inline">\(116.8 -
11.8 - 6.1 = 98.9\)</span>.</p>
<p>If you want to check that this is correct, the mean duration of
<code>u</code> according to the model above where we used treatment
contrasts was <span class="math inline">\(128.616 - 29.763 =
98.853\)</span>.</p>
</div>
<div class="section level3">
<h3 id="sum-contrasts-and-interactions">Sum contrasts and interactions<a class="anchor" aria-label="anchor" href="#sum-contrasts-and-interactions"></a>
</h3>
<p>Sum contrasts can be very handy when the model contains interactions
between factors.</p>
<p>Let’s say we want to include in our model of vowel duration a
predictor that specifies the voicing of the stop following the vowel. We
also add an interaction between vowel and voicing, so that we can model
differences in the effect of voicing across vowels.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vow_lm_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">v1_duration</span> <span class="op">~</span> <span class="va">c2_voicing</span> <span class="op">+</span> <span class="va">vowel</span> <span class="op">+</span> <span class="va">c2_voicing</span><span class="op">:</span><span class="va">vowel</span>, data <span class="op">=</span> <span class="va">vowels</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">vow_lm_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = v1_duration ~ c2_voicing + vowel + c2_voicing:vowel, </span></span>
<span><span class="co">#&gt;     data = vowels)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -64.905 -23.262  -2.033  18.134 115.813 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                            Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)                 123.469      1.449  85.232  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; c2_voicingvoiceless         -13.309      2.049  -6.496 1.37e-10 ***</span></span>
<span><span class="co">#&gt; vowel1                       14.606      2.037   7.171 1.57e-12 ***</span></span>
<span><span class="co">#&gt; vowel2                        8.564      2.033   4.212 2.79e-05 ***</span></span>
<span><span class="co">#&gt; c2_voicingvoiceless:vowel1   -5.609      2.880  -1.947   0.0518 .  </span></span>
<span><span class="co">#&gt; c2_voicingvoiceless:vowel2   -4.808      2.876  -1.672   0.0949 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 30.47 on 880 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1937, Adjusted R-squared:  0.1891 </span></span>
<span><span class="co">#&gt; F-statistic: 42.29 on 5 and 880 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Now the <code>Intercept</code> is the mean vowel duration when the
following stop is voiced (the reference level of
<code>c2_voicing</code>). This means that the average vowel followed by
a voiced stop is 123 ms long in our data.</p>
<p>The coefficient of <code>c2_voicingvoiceless</code> tells us the mean
effect of <code>c2_voicing</code> on vowel duration, averaged across all
vowels. So, on average, a vowel is about 13 ms shorter when followed by
a voiceless stop.</p>
<p>The coefficients of <code>vowel1</code> and <code>vowel2</code>
indicate the difference between the average vowel duration before a
voiced stop (the <code>Intercept</code>) and <code>a</code> and
<code>o</code> respectively. As before, to get the difference between
the average vowel duration of <code>u</code> before a voiceless stop and
the mean vowel duration, you just need to subtract the coefficients of
<code>vowel1</code> and <code>vowel2</code> from the
<code>Intercept</code>: <span class="math inline">\(123.5 - 14.6 - 8.5 =
100.4\)</span>.</p>
<p>The last two coefficients, <code>c2_voicingvoiceless:vowel1</code>
and <code>c2_voicingvoiceless:vowel2</code> correspond to the difference
in the effect of voicing between the average effect of voicing
(<code>c2_voicingvoiceless</code>, i.e. -13 ms) and the effect of
voicing in <code>a</code> and <code>o</code> respectively. That is, the
decrease of vowel duration for <code>a</code> is 5.6 ms greater than the
average effect, while the decrease of vowel duration for <code>o</code>
is 4.8 ms greater than the average effect.</p>
<p>Following the usual formula, the effect of voicing for <code>u</code>
is <span class="math inline">\(-13.309 - (-5.6) - (-4.8) =
-2.9\)</span>.</p>
<p><br></p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Stefano Coretta, Joseph V. Casillas, Timo Roettger.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
